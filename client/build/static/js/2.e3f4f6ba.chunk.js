"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[2],{8987:function(e,t,n){n.d(t,{Z:function(){return o}});var i=n(4440),r=n(4070),a=n(184);function o(e){return(0,a.jsx)(i.Z,{open:e.openSnackBar,autoHideDuration:8e3,onClose:e.closeSnackBar,anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,a.jsx)(r.Z,{onClose:e.closeSnackBar,severity:e.severity?"success":"error",sx:{width:"100%"},children:e.message})})}},7002:function(e,t,n){n.r(t),n.d(t,{default:function(){return me}});var i=n(9439),r=n(2791),a=n(9953),o=n(7621),c=n(5117),s=n(3786),l=n(4182),u=n(184);function d(e){var t,n=r.useState(e.currType),d=(0,i.Z)(n,2),f=d[0],p=d[1],v=l.Z.getState().CategoryReducer.categoryList;return(0,u.jsxs)(a.ZP,{variant:"permanent",anchor:"left",PaperProps:{sx:{position:"inherit"}},className:"drawer",children:[(0,u.jsx)("div",{className:"drawer_ContentWrapper",children:Object.keys(v).map((function(t){return(0,u.jsx)("div",{children:(0,u.jsx)(o.Z,{onClick:function(t){e.typeClick(t),p(t.target.textContent)},className:"drawer_card",children:t.toString()})},t)}))}),(0,u.jsx)(c.Z,{anchorEl:e.anchorEl,open:e.open,onClose:e.closeMenu,children:null===(t=v[f])||void 0===t?void 0:t.map((function(t){return(0,u.jsx)(s.Z,{onClick:function(t){return e.subTypeChange(t,f)},children:t},t)}))})]})}var f=n(1413),p=n(4165),v=n(5861),g=n(3433),h=n(5671),Z=n(3144),m=n(136),x=n(7277),C=n(9281),y=n(9836),j=n(6890),D=n(5855),k=n(3994),b=n(4454),S=n(720),I=n(4554),E=n(3382),w=n(7462),N=n(3366),A=n(8182),M=n(4419),_=n(829),L=n(1046),P=n(6934),F=n(5878),B=n(1217);function R(e){return(0,B.Z)("MuiTableFooter",e)}(0,F.Z)("MuiTableFooter",["root"]);var O=["className","component"],T=(0,P.ZP)("tfoot",{name:"MuiTableFooter",slot:"Root",overridesResolver:function(e,t){return t.root}})({display:"table-footer-group"}),z={variant:"footer"},$="tfoot",H=r.forwardRef((function(e,t){var n=(0,L.Z)({props:e,name:"MuiTableFooter"}),i=n.className,r=n.component,a=void 0===r?$:r,o=(0,N.Z)(n,O),c=(0,w.Z)({},n,{component:a}),s=function(e){var t=e.classes;return(0,M.Z)({root:["root"]},R,t)}(c);return(0,u.jsx)(_.Z.Provider,{value:z,children:(0,u.jsx)(T,(0,w.Z)({as:a,className:(0,A.Z)(s.root,i),ref:t,role:a===$?null:"rowgroup",ownerState:c},o))})})),q=n(6775),W=n(828),V=n(68),U=n(3400),G=n(9126),J=n(6918),K=n(5289),Q=n(5661),X=n(9157),Y=n(6151),ee=n(7071),te=n(8550),ne=n(7123),ie=n(784);function re(e){var t,n,a,o,c,d,p,v,g,h,Z,m,x=(0,r.useState)("".concat(ie.Z,"/").concat(null===(t=e.item)||void 0===t?void 0:t.PID)),C=(0,i.Z)(x,2),y=C[0],j=C[1],D=(0,r.useState)(null),k=(0,i.Z)(D,2),b=k[0],S=k[1],I=(0,r.useState)("not selected"),E=(0,i.Z)(I,2),w=E[0],N=E[1],A=(0,r.useState)(e.item),M=(0,i.Z)(A,2),_=M[0],L=M[1],P=(0,r.useRef)(),F=l.Z.getState().CategoryReducer.CIDList,B=(0,r.useState)(null!==_&&void 0!==_&&_.category?null===(n=F.find((function(e){return e.NAME===_.category})))||void 0===n||null===(a=n.subCategories)||void 0===a?void 0:a.split(","):null===(o=F[0])||void 0===o?void 0:o.subCategories.split(",")),R=(0,i.Z)(B,2),O=R[0],T=R[1],z=function(e,t){var n,i,r=(0,f.Z)({},_);"category"===t&&e.target.value!==(null===_||void 0===_?void 0:_.category)&&(r.subCategory=null===(n=F.find((function(t){return t.NAME===e.target.value})))||void 0===n?void 0:n.subCategories.split(",")[0],r.CID=null===(i=F.find((function(t){return t.NAME===e.target.value})))||void 0===i?void 0:i.CID);r[t]=e.target.value,L(r)},$=function(){j(null),L(null),N("not selected")};return(0,r.useEffect)((function(){var t,n,i,r,a,o,c,s;(L(e.item),null!==(t=e.item)&&void 0!==t&&t.category)?(j("".concat(ie.Z,"/").concat(null===(n=e.item)||void 0===n?void 0:n.PID)),T(null===(i=F.find((function(t){return t.NAME===e.item.category})))||void 0===i||null===(r=i.subCategories)||void 0===r?void 0:r.split(","))):(L((0,f.Z)((0,f.Z)({},e.item),{},{category:null===(a=F[0])||void 0===a?void 0:a.NAME,subCategory:null===(o=F[0])||void 0===o?void 0:o.subCategories.split(",")[0]})),j(null),T(null===(c=F[0])||void 0===c||null===(s=c.subCategories)||void 0===s?void 0:s.split(",")));return function(){$()}}),[e.item,F]),(0,u.jsxs)(K.Z,{open:e.open,onClose:function(){e.closeDialog(),$()},maxWidth:"lg",fullWidth:!0,scroll:"body",children:[(0,u.jsx)(Q.Z,{children:(0,u.jsx)("div",{className:"EditDialog_title",children:"Editing"})}),(0,u.jsxs)(X.Z,{className:"EditDialog_contentWrapper",children:[(0,u.jsxs)("div",{className:"EditDialog_leftContent",children:[(0,u.jsxs)(Y.Z,{variant:"contained",onClick:function(){P.current.click()},children:["Click to upload file",(0,u.jsx)("input",{ref:P,type:"file",accept:"image/png,image/gif,image/jpg",onChange:function(e){return function(e){var t;e.target.files&&(N(null===(t=e.target.files[0])||void 0===t?void 0:t.name),j(URL.createObjectURL(e.target.files[0])),S(e.target.files[0]))}(e)},className:"EditDialog_imgInput"})]}),(0,u.jsx)("br",{}),(0,u.jsx)("img",{onDrop:function(e){return function(e){var t;e.preventDefault(),e.dataTransfer.files&&(N(null===(t=e.dataTransfer.files[0])||void 0===t?void 0:t.name),j(URL.createObjectURL(e.dataTransfer.files[0])),S(e.target.files[0]))}(e)},onDragOver:function(e){return function(e){e.preventDefault()}(e)},className:"EditDialog_imgUploadArea",src:y,alt:" or drag and drop your file here"}),(0,u.jsx)(ee.Z,{children:w}),(0,u.jsx)(te.Z,{required:!0,label:"Name",variant:"outlined",margin:"dense",onChange:function(e){return z(e,"name")},defaultValue:null===(c=e.item)||void 0===c?void 0:c.name}),(0,u.jsx)(te.Z,{required:!0,label:"PrevPrice",variant:"outlined",margin:"dense",onChange:function(e){return z(e,"prevPrice")},defaultValue:null===(d=e.item)||void 0===d?void 0:d.prevPrice}),(0,u.jsx)(te.Z,{required:!0,label:"Price",variant:"outlined",margin:"dense",onChange:function(e){return z(e,"price")},defaultValue:null===(p=e.item)||void 0===p?void 0:p.price}),(0,u.jsx)(te.Z,{required:!0,label:"Stock",variant:"outlined",margin:"dense",onChange:function(e){return z(e,"inventory")},defaultValue:null===(v=e.item)||void 0===v?void 0:v.inventory})]}),(0,u.jsxs)("div",{className:"EditDialog_rightContent",children:[(0,u.jsx)(te.Z,{required:!0,label:"Description",variant:"outlined",className:"EditDialog_formComponent",onChange:function(e){return z(e,"description")},defaultValue:null===(g=e.item)||void 0===g?void 0:g.description,multiline:!0,rows:10,margin:"dense"}),(0,u.jsx)(te.Z,{select:!0,label:"Type",value:(null===_||void 0===_?void 0:_.category)||(null===(h=F[0])||void 0===h?void 0:h.NAME),helperText:"Please select type",onChange:function(e){var t;z(e,"category"),T(null===(t=F.find((function(t){return t.NAME===e.target.value})))||void 0===t?void 0:t.subCategories.split(","))},margin:"dense",children:null===F||void 0===F?void 0:F.map((function(e){return(0,u.jsx)(s.Z,{value:e.NAME,children:e.NAME},e.CID)}))}),(0,u.jsx)(te.Z,{select:!0,label:"Subtype",value:null!==_&&void 0!==_&&_.subCategory?null===_||void 0===_?void 0:_.subCategory:null===(Z=F[0])||void 0===Z?void 0:Z.subCategories.split(",")[0],helperText:"Please select subtype",onChange:function(e){z(e,"subCategory")},margin:"dense",children:O?null===O||void 0===O?void 0:O.map((function(e){return(0,u.jsx)(s.Z,{value:e,children:e},e)})):(0,u.jsx)(s.Z,{})}),(0,u.jsx)(te.Z,{required:!0,label:"comeFrom",variant:"outlined",margin:"dense",onChange:function(e){return z(e,"comeFrom")},defaultValue:null===(m=e.item)||void 0===m?void 0:m.comeFrom})]})]}),(0,u.jsxs)(ne.Z,{children:[(0,u.jsx)(Y.Z,{onClick:e.closeDialog,children:"Back"}),(0,u.jsx)(Y.Z,{onClick:function(){var t=(0,f.Z)({},_);e.submitHandler(t,b),e.closeDialog()},children:"Submit"})]})]})}var ae=n(8652),oe=n(2032),ce=n(6212),se=n(3362),le=n(8987),ue=function(e){(0,m.Z)(n,e);var t=(0,x.Z)(n);function n(){var e;(0,h.Z)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={selectedItems:[],detailDialogOpen:!1,detailDialogItem:null,editDialogOpen:!1,editDialogItem:null,openSnackBar:!1,snackBarMessage:"",snackBarSeverity:!1},e.AllClick=function(t){t.target.checked?e.setState({selectedItems:(0,g.Z)(e.props.displayList)}):e.setState({selectedItems:[]})},e.fetchData=(0,v.Z)((0,p.Z)().mark((function e(){var t;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae.Z.get_categoryList().then((function(e){return t=e.data})).catch((function(e){return console.log(e)}));case 2:return e.next=4,ae.Z.get_productList().then((function(e){var n=e.data,i={},r={},a={};t.forEach((function(e){i[e.NAME]={};var t=e.subCategories.split(",");r[e.NAME]=t,a[e.NAME]=e.NavListIcon,t.forEach((function(t){i[e.NAME][t]=[]}))})),n.forEach((function(e){var n;e.inventory=parseInt(e.inventory),e.category=null===(n=t.find((function(t){return t.CID===e.CID})))||void 0===n?void 0:n.NAME,i[e.category][e.subCategory].push(e)})),l.Z.dispatch((0,ce.qA)(a)),l.Z.dispatch((0,ce.af)(r)),l.Z.dispatch((0,oe.t)(i)),l.Z.dispatch((0,ce.io)(t))})).catch((function(e){return console.log(e)}));case 4:return e.next=6,ae.Z.get_homeList().then((function(e){var t=e.data,n=[];t.forEach((function(e){var t={name:e.name,id:e.CID,value:e.value.split(",")};n.push(t)})),l.Z.dispatch((0,se.c)(n))})).catch((function(e){return console.log(e)}));case 6:case"end":return e.stop()}}),e)}))),e.checkHandler=function(t,n){if(t.target.checked)e.setState({selectedItems:[].concat((0,g.Z)(e.state.selectedItems),[n])});else{var i=e.state.selectedItems.filter((function(e){return e.PID!==n.PID}));e.setState({selectedItems:i})}},e.openDetailDialog=function(t){e.setState({detailDialogItem:t,detailDialogOpen:!0})},e.closeDetailDialog=function(){e.setState({detailDialogItem:null,detailDialogOpen:!1})},e.openEditDialog=function(t){e.setState({editDialogItem:t,editDialogOpen:!0})},e.closeEditDialog=function(){e.setState({editDialogItem:null,editDialogOpen:!1})},e.closeSnackBar=function(){e.setState({openSnackBar:!1})},e.checking=function(e,t){var n="",i="",r="";return e.name||(n+="Name "),e.prevPrice||(n+="PrevPirce "),e.price||(n+="Price "),e.inventory||(n+="Stock "),e.description||(n+="Description "),e.comeFrom||(n+="Comefrom "),n&&(n+="missing! "),/^-?[0-9]+([.,][0-9]+)?$/.test(e.price)&&/^-?[0-9]+([.,][0-9]+)?$/.test(e.prevPrice)||(i+="price "),/^\d+$/.test(e.inventory)||(i+="inventory "),/^[A-Za-z0-9\s]+$/.test(e.name)||(i+="name "),/^[A-Za-z]+$/.test(e.ComeFrom)||(i+="comeFrom "),/^[a-zA-Z ]*$/.test(e.Descrition)||(i+="Description "),i&&(i+="format not correct! "),(null===t||void 0===t?void 0:t.size)>5240880&&(r="image too big,pls upload size below 5MB"),n+" "+i+r},e.submitHandler=function(t,n){var i=(0,f.Z)({},t),r=e.checking(i,n);if(" "===r){var a=new FormData;Object.keys(i).forEach((function(e){a.append(e,t[e])})),n&&a.append("file",n,null===n||void 0===n?void 0:n.name),ae.Z.update_to_productList(a).then(function(){var t=(0,v.Z)((0,p.Z)().mark((function t(n){return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({snackBarSeverity:!0,openSnackBar:!0,snackBarMessage:n.data}),e.closeEditDialog(),t.next=4,e.fetchData();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.setState({snackBarSeverity:!1,openSnackBar:!0,snackBarMessage:t.response.data}),"cookie expired"!==t.response.data&&"Fail to pass checking"!==t.response.data||(window.location.pathname="/login")}))}else e.setState({snackBarSeverity:!1,openSnackBar:!0,snackBarMessage:"Insert Failed => ".concat(r)})},e.deleteItem=function(t){if(window.confirm("delete it?")){var n=new FormData;n.append("PID",null===t||void 0===t?void 0:t.PID),ae.Z.delete_from_productList(n).then(function(){var t=(0,v.Z)((0,p.Z)().mark((function t(n){return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({snackBarSeverity:!0,openSnackBar:!0,snackBarMessage:n.data}),t.next=3,e.fetchData();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){var n,i;e.setState({snackBarSeverity:!1,openSnackBar:!0,snackBarMessage:t.response.data}),"cookie expired"!==(null===(n=t.response)||void 0===n?void 0:n.data)&&"Fail to pass checking"!==(null===(i=t.response)||void 0===i?void 0:i.data)||(window.location.pathname="/login")}))}},e}return(0,Z.Z)(n,[{key:"render",value:function(){var e,t=this;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(C.Z,{children:[(0,u.jsxs)(y.Z,{children:[(0,u.jsx)(j.Z,{children:(0,u.jsxs)(D.Z,{children:[(0,u.jsxs)(k.Z,{padding:"checkbox",children:[(0,u.jsx)(b.Z,{color:"primary",checked:this.state.selectedItems.length===this.props.listLength,onChange:function(e){return t.AllClick(e)}}),this.state.selectedItems.length>0?(0,u.jsx)("button",{children:"Remove Selected"}):(0,u.jsx)("div",{})]}),this.props.tableHeader.map((function(e){return(0,u.jsx)(k.Z,{align:"left",children:(0,u.jsxs)(S.Z,{active:!1,direction:"asc",children:[e.label,(0,u.jsx)(I.Z,{component:"span"})]})},e.id)}))]})}),(0,u.jsx)(E.Z,{children:null===(e=this.props.displayList)||void 0===e?void 0:e.map((function(e){return(0,u.jsxs)(D.Z,{children:[(0,u.jsx)(k.Z,{padding:"checkbox",children:(0,u.jsx)(b.Z,{color:"primary",checked:t.state.selectedItems.findIndex((function(t){return t.PID===e.PID}))>-1,onChange:function(n){return t.checkHandler(n,e)}})}),(0,u.jsx)(k.Z,{children:e.PID}),(0,u.jsx)(k.Z,{children:(0,u.jsx)("div",{children:(0,u.jsx)("img",{src:"".concat(ie.Z,"/").concat(e.PID),alt:"not found",className:"adminTable_img"})})}),(0,u.jsxs)(k.Z,{children:["$",e.price]}),(0,u.jsx)(k.Z,{children:e.name}),(0,u.jsx)(k.Z,{children:parseInt(e.inventory)}),(0,u.jsxs)(k.Z,{children:[(0,u.jsx)(V.Z,{title:"View",children:(0,u.jsx)(U.Z,{onClick:function(){return t.openDetailDialog(e)},children:(0,u.jsx)(G.xt8,{size:28})})}),(0,u.jsx)(V.Z,{title:"Edit",children:(0,u.jsx)(U.Z,{onClick:function(){return t.openEditDialog(e)},children:(0,u.jsx)(G.Ph1,{size:28})})}),(0,u.jsx)(V.Z,{title:"Delete",children:(0,u.jsx)(U.Z,{onClick:function(){t.deleteItem(e)},children:(0,u.jsx)(W._51,{size:28})})})]})]},e.PID)}))}),(0,u.jsx)(H,{children:(0,u.jsx)(D.Z,{children:(0,u.jsx)(q.Z,{rowsPerPageOptions:[5,10,15],count:this.props.listLength,rowsPerPage:this.props.tableRowsNum,page:this.props.tablePage,onPageChange:function(e,n){return t.props.tablePageChange(e,n)},onRowsPerPageChange:function(e){return t.props.tableRowsChange(e)}})})})]}),(0,u.jsx)(J.Z,(0,f.Z)((0,f.Z)({},this.state.detailDialogItem),{},{type:this.props.type,subType:this.props.subType,open:this.state.detailDialogOpen,openDialog:this.openDetailDialog,closeDialog:this.closeDetailDialog})),(0,u.jsx)(re,{submitHandler:this.submitHandler,item:this.state.editDialogItem,open:this.state.editDialogOpen,closeDialog:this.closeEditDialog})]}),(0,u.jsx)(le.Z,{openSnackBar:this.state.openSnackBar,closeSnackBar:this.closeSnackBar,severity:this.state.snackBarSeverity,message:this.state.snackBarMessage})]})}}]),n}(r.Component),de=n(6362);function fe(e){var t=(0,r.useState)(e.content),n=(0,i.Z)(t,2),a=n[0],o=n[1],c=(0,r.useState)(e.content),s=(0,i.Z)(c,2),l=s[0],d=s[1];return(0,r.useEffect)((function(){o(e.content),d(e.content)}),[e.content]),(0,u.jsxs)(K.Z,{open:e.open,onClose:e.closeDialog,maxWidth:"xs",fullWidth:!0,scroll:"body",children:[(0,u.jsx)(Q.Z,{children:e.title}),(0,u.jsx)(X.Z,{children:(0,u.jsx)(de.Z,{children:(0,u.jsx)(te.Z,{required:!0,label:e.title,variant:"outlined",value:a,onChange:function(e){return function(e){o(e.target.value)}(e)},autoFocus:!0,className:"TextFieldDialog_textfield"})})}),(0,u.jsxs)(ne.Z,{children:[(0,u.jsx)(Y.Z,{onClick:e.closeDialog,children:"Back"}),(0,u.jsx)(Y.Z,{onClick:function(){e.submitHandler(a,l),o(""),e.closeDialog()},children:"Submit"})]})]})}var pe=n(7689);function ve(e){var t,n,a,o=(0,pe.s0)(),c=(0,r.useState)(l.Z.getState().CategoryReducer.CIDList),d=(0,i.Z)(c,2),f=d[0],g=d[1],h=(0,r.useState)(null===(t=f[0])||void 0===t?void 0:t.NAME),Z=(0,i.Z)(h,2),m=Z[0],x=Z[1],b=(0,r.useState)(null===(n=f[0])||void 0===n||null===(a=n.subCategories)||void 0===a?void 0:a.split(",")),S=(0,i.Z)(b,2),I=S[0],w=S[1],N=(0,r.useState)(!1),A=(0,i.Z)(N,2),M=A[0],_=A[1],L=(0,r.useState)("new"),P=(0,i.Z)(L,2),F=P[0],B=P[1],R=(0,r.useState)(""),O=(0,i.Z)(R,2),T=O[0],z=O[1],$=(0,r.useState)(null),H=(0,i.Z)($,2),q=H[0],J=H[1],ee=(0,r.useState)(!1),ie=(0,i.Z)(ee,2),re=ie[0],ue=ie[1],de=(0,r.useState)(""),ve=(0,i.Z)(de,2),ge=ve[0],he=ve[1],Ze=(0,r.useState)(!0),me=(0,i.Z)(Ze,2),xe=me[0],Ce=me[1],ye=function(e,t,n){B(e),z(t),J(n),_(!0)},je=function(){var e=(0,v.Z)((0,p.Z)().mark((function e(){var t;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae.Z.get_categoryList().then((function(e){return t=e.data})).catch((function(e){return console.log(e)}));case 2:return e.next=4,ae.Z.get_productList().then((function(e){var n=e.data,i={},r={},a={};t.forEach((function(e){i[e.NAME]={};var t=e.subCategories.split(",");r[e.NAME]=t,a[e.NAME]=e.NavListIcon,t.forEach((function(t){i[e.NAME][t]=[]}))})),n.forEach((function(e){var n;e.inventory=parseInt(e.inventory),e.category=null===(n=t.find((function(t){return t.CID===e.CID})))||void 0===n?void 0:n.NAME,i[e.category][e.subCategory].push(e)})),l.Z.dispatch((0,ce.qA)(a)),l.Z.dispatch((0,ce.af)(r)),l.Z.dispatch((0,oe.t)(i)),l.Z.dispatch((0,ce.io)(t))})).catch((function(e){return console.log(e)}));case 4:return e.next=6,ae.Z.get_homeList().then((function(e){var t=e.data,n=[];t.forEach((function(e){var t={name:e.name,id:e.CID,value:e.value.split(",")};n.push(t)})),l.Z.dispatch((0,se.c)(n))})).catch((function(e){return console.log(e)}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),De=function(e){return/^[a-zA-Z ]*$/.test(e)},ke=function(e,t){var n;if(!e||!De(e))return Ce(!1),he("Format not match!"),void ue(!0);var i=new FormData,r={CID:null===(n=f.find((function(e){return e.NAME===m})))||void 0===n?void 0:n.CID,category:m,newIcon:e};Object.keys(r).forEach((function(e){i.append(e,r[e])})),ae.Z.update_icon_to_category(i).then(function(){var e=(0,v.Z)((0,p.Z)().mark((function e(t){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ce(!0),he(t.data),ue(!0),e.next=5,je();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){Ce(!1),he("insert fail "+e.response.data),ue(!0),"cookie expired"!==e.response.data&&"Fail to pass checking"!==e.response.data||o("/login")}))},be=function(e,t){var n;if(!e||!De(e))return Ce(!1),he("Format not match!"),void ue(!0);var i=new FormData,r={CID:null===(n=f.find((function(e){return e.NAME===m})))||void 0===n?void 0:n.CID,category:m,originSubCategory:t,newSubCategory:e};Object.keys(r).forEach((function(e){i.append(e,r[e])})),ae.Z.update_subCate_to_category(i).then(function(){var e=(0,v.Z)((0,p.Z)().mark((function e(t){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ce(!0),he(t.data),ue(!0),e.next=5,je();case 5:g(l.Z.getState().CategoryReducer.CIDList);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){Ce(!1),he("insert fail "+e.response.data),ue(!0),"cookie expired"!==e.response.data&&"Fail to pass checking"!==e.response.data||o("/login")}))},Se=function(e,t){var n;if(!e||!De(e))return Ce(!1),he("Format not match!"),void ue(!0);var i=new FormData,r={CID:null===(n=f.find((function(e){return e.NAME===m})))||void 0===n?void 0:n.CID,originCategory:t,newCategory:e};Object.keys(r).forEach((function(e){i.append(e,r[e])})),ae.Z.update_to_category(i).then(function(){var t=(0,v.Z)((0,p.Z)().mark((function t(n){return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Ce(!0),he(n.data),ue(!0),t.next=5,je();case 5:x(e),g(l.Z.getState().CategoryReducer.CIDList);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){Ce(!1),he("insert fail "+e.response.data),ue(!0),"cookie expired"!==e.response.data&&"Fail to pass checking"!==e.response.data||o("/login")}))},Ie=function(e,t){var n;if(!e||!De(e))return Ce(!1),he("Format not match!"),void ue(!0);var i=new FormData,r={CID:null===(n=f.find((function(e){return e.NAME===m})))||void 0===n?void 0:n.CID,category:m,subCategory:e};Object.keys(r).forEach((function(e){i.append(e,r[e])})),ae.Z.insert_subCate_to_category(i).then(function(){var e=(0,v.Z)((0,p.Z)().mark((function e(t){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ce(!0),he(t.data),ue(!0),e.next=5,je();case 5:g(l.Z.getState().CategoryReducer.CIDList);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){Ce(!1),he("insert fail "+e.response.data),ue(!0),"cookie expired"!==e.response.data&&"Fail to pass checking"!==e.response.data||o("/login")}))},Ee=function(e,t){var n;if(!e||!De(e))return Ce(!1),he("Format not match!"),void ue(!0);var i=new FormData,r={CID:null===(n=f.find((function(e){return e.NAME===m})))||void 0===n?void 0:n.CID,category:e,subCategory:"new"};Object.keys(r).forEach((function(e){i.append(e,r[e])})),ae.Z.insert_to_category(i).then(function(){var t=(0,v.Z)((0,p.Z)().mark((function t(n){return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Ce(!0),he(n.data),ue(!0),t.next=5,je();case 5:x(e),g(l.Z.getState().CategoryReducer.CIDList);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){Ce(!0),he("insert fail "+e.response.data),ue(!0),"cookie expired"!==e.response.data&&"Fail to pass checking"!==e.response.data||o("/login")}))};return(0,r.useEffect)((function(){var e,t;w(null===(e=f.find((function(e){return e.NAME===m})))||void 0===e||null===(t=e.subCategories)||void 0===t?void 0:t.split(","))}),[f,m]),(0,u.jsxs)("div",{children:[(0,u.jsxs)(K.Z,{open:e.open,onClose:e.closeDialog,maxWidth:"lg",fullWidth:!0,scroll:"body",children:[(0,u.jsx)(Q.Z,{children:(0,u.jsx)("div",{className:"EditCateDialog_title",children:"Editing category"})}),(0,u.jsxs)(X.Z,{className:"EditCateDialog_dialogContent",children:[(0,u.jsx)(Y.Z,{onClick:function(){return ye("create Category","",(function(){return Ee}))},children:"new Category"}),(0,u.jsx)(Y.Z,{onClick:function(){return ye("create subCategory for ".concat(m),"",(function(){return Ie}))},children:"new SubCategory"}),(0,u.jsx)(te.Z,{select:!0,label:"Category",value:m,helperText:"Please select category",onChange:function(e){!function(e){var t,n;x(e.target.value),w(null===(t=f.find((function(t){return t.NAME===e.target.value})))||void 0===t||null===(n=t.subCategories)||void 0===n?void 0:n.split(","))}(e)},className:"EditCateDialog_selectField",children:null===f||void 0===f?void 0:f.map((function(e){return(0,u.jsx)(s.Z,{value:e.NAME,children:e.NAME},e.CID)}))}),(0,u.jsx)(Y.Z,{variant:"outlined",onClick:function(){return ye("Editing ".concat(m),m,(function(){return Se}))},children:"Edit category"}),(0,u.jsx)(Y.Z,{variant:"outlined",onClick:function(){return ye("Editing ".concat(m," icon"),"",(function(){return ke}))},children:"Edit category icon"}),(0,u.jsx)(Y.Z,{variant:"outlined",color:"error",onClick:function(){var e;if(window.confirm("you can't delete it if there are items belongs to this category,continue?")){var t=new FormData,n={CID:null===(e=f.find((function(e){return e.NAME===m})))||void 0===e?void 0:e.CID,category:m};Object.keys(n).forEach((function(e){t.append(e,n[e])})),ae.Z.delete_from_category(t).then(function(){var e=(0,v.Z)((0,p.Z)().mark((function e(t){var n;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ce(!0),he(t.data),ue(!0),e.next=5,je();case 5:x(null===(n=f.find((function(e){return e.NAME!==m})))||void 0===n?void 0:n.NAME),g(l.Z.getState().CategoryReducer.CIDList);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){Ce(!1),he("delete fail "+e.response.data),ue(!0),"cookie expired"!==e.response.data&&"Fail to pass checking"!==e.response.data||o("/login")}))}},children:"Delete category"}),(0,u.jsx)(C.Z,{children:(0,u.jsxs)(y.Z,{children:[(0,u.jsx)(j.Z,{children:(0,u.jsxs)(D.Z,{children:[(0,u.jsx)(k.Z,{children:"subCategory"}),(0,u.jsx)(k.Z,{children:"Action"})]})}),(0,u.jsx)(E.Z,{children:null===I||void 0===I?void 0:I.map((function(e){return(0,u.jsxs)(D.Z,{children:[(0,u.jsx)(k.Z,{children:e}),(0,u.jsxs)(k.Z,{children:[(0,u.jsx)(V.Z,{title:"Edit",children:(0,u.jsx)(U.Z,{onClick:function(){return ye("edit subcate",e,(function(){return be}))},children:(0,u.jsx)(G.Ph1,{size:28})})}),(0,u.jsx)(V.Z,{title:"Delete",children:(0,u.jsx)(U.Z,{onClick:function(){return function(e){var t;if(window.confirm("you can not delete any category before its' items are deleted,continue?")){var n=new FormData,i={CID:null===(t=f.find((function(e){return e.NAME===m})))||void 0===t?void 0:t.CID,category:m,subCategory:e};Object.keys(i).forEach((function(e){n.append(e,i[e])})),ae.Z.delete_subCate_from_category(n).then(function(){var e=(0,v.Z)((0,p.Z)().mark((function e(t){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ce(!0),he(t.data),ue(!0),e.next=5,je();case 5:g(l.Z.getState().CategoryReducer.CIDList);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){Ce(!1),he("delete fail "+e.response.data),ue(!0),"cookie expired"!==e.response.data&&"Fail to pass checking"!==e.response.data||o("/login")}))}}(e)},children:(0,u.jsx)(W._51,{size:28})})})]})]},e)}))})]})})]}),(0,u.jsx)(ne.Z,{children:(0,u.jsx)(Y.Z,{onClick:e.closeDialog,children:"Back"})})]}),(0,u.jsx)(fe,{open:M,title:F,closeDialog:function(){_(!1)},content:T,submitHandler:q}),(0,u.jsx)(le.Z,{openSnackBar:re,closeSnackBar:function(){ue(!1)},severity:xe,message:ge})]})}var ge=n(2775);function he(e){var t=(0,pe.s0)(),n=r.useState(!1),a=(0,i.Z)(n,2),o=a[0],c=a[1],s=r.useState(!1),d=(0,i.Z)(s,2),g=d[0],h=d[1],Z=r.useState(!1),m=(0,i.Z)(Z,2),x=m[0],C=m[1],y=r.useState(!1),j=(0,i.Z)(y,2),D=j[0],k=j[1],b=r.useState(""),S=(0,i.Z)(b,2),I=S[0],E=S[1],w=r.useState(!0),N=(0,i.Z)(w,2),A=N[0],M=N[1],_=function(){var e=(0,v.Z)((0,p.Z)().mark((function e(){var t;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae.Z.get_categoryList().then((function(e){return t=e.data})).catch((function(e){return console.log(e)}));case 2:return e.next=4,ae.Z.get_productList().then((function(e){var n=e.data,i={},r={},a={};t.forEach((function(e){i[e.NAME]={};var t=e.subCategories.split(",");r[e.NAME]=t,a[e.NAME]=e.NavListIcon,t.forEach((function(t){i[e.NAME][t]=[]}))})),n.forEach((function(e){var n;e.inventory=parseInt(e.inventory),e.category=null===(n=t.find((function(t){return t.CID===e.CID})))||void 0===n?void 0:n.NAME,i[e.category][e.subCategory].push(e)})),l.Z.dispatch((0,ce.qA)(a)),l.Z.dispatch((0,ce.af)(r)),l.Z.dispatch((0,oe.t)(i)),l.Z.dispatch((0,ce.io)(t))})).catch((function(e){return console.log(e)}));case 4:return e.next=6,ae.Z.get_homeList().then((function(e){var t=e.data,n=[];t.forEach((function(e){var t={name:e.name,id:e.CID,value:e.value.split(",")};n.push(t)})),l.Z.dispatch((0,se.c)(n))})).catch((function(e){return console.log(e)}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,u.jsxs)("div",{className:"ButtonList_Wrapper",children:[(0,u.jsx)(Y.Z,{color:"secondary",variant:"outlined",onClick:function(){C(!0)},children:"History order"}),(0,u.jsx)(Y.Z,{color:"secondary",variant:"outlined",onClick:function(){c(!0)},children:"Create item"}),(0,u.jsx)(Y.Z,{color:"secondary",variant:"outlined",onClick:function(){h(!0)},children:"Edit Category"}),(0,u.jsx)(Y.Z,{color:"secondary",variant:"contained",onClick:function(){window.location.reload(!0)},children:"Click for reload"}),(0,u.jsx)(ge.Z,{open:x,closeDialog:function(){C(!1)},getAll:!0}),(0,u.jsx)(re,{item:{},open:o,closeDialog:function(){c(!1)},submitHandler:function(e,n){var i=(0,f.Z)({},e),r=function(e,t){var n="",i="",r="";return e.name||(n+="Name "),e.prevPrice||(n+="PrevPirce "),e.price||(n+="Price "),e.inventory||(n+="Stock "),e.description||(n+="Description "),e.comeFrom||(n+="Comefrom "),t||(n+="Image "),n&&(n+="missing! "),/^-?[0-9]+([.,][0-9]+)?$/.test(e.price)&&/^-?[0-9]+([.,][0-9]+)?$/.test(e.prevPrice)||(i+="price "),/^\d+$/.test(e.inventory)||(i+="inventory "),/^[A-Za-z0-9\s]+$/.test(e.name)||(i+="name "),/^[A-Za-z]+$/.test(e.ComeFrom)||(i+="comeFrom "),/^[A-Za-z0-9 _]*[A-Za-z0-9][A-Za-z0-9 _]*$/.test(e.Descrition)||(i+="Description "),i&&(i+="format not correct! "),(null===t||void 0===t?void 0:t.size)>5242880&&(r="image too big,pls upload beload 5MB"),n+" "+i+r}(i,n);if(" "!==r)return E("Insert Failed => ".concat(r)),M(!1),void k(!0);var a=new FormData;Object.keys(i).forEach((function(t){a.append(t,e[t])})),a.append("file",n,n.name),ae.Z.insert_to_productList(a).then(function(){var e=(0,v.Z)((0,p.Z)().mark((function e(t){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M(!0),c(!1),E(t.data),k(!0),e.next=6,_();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){M(!1),E("Insert Failed => ".concat(r)),k(!0),"cookie expired"!==e.response.data&&"Fail to pass checking"!==e.response.data||t("/login")}))}}),(0,u.jsx)(ve,{open:g,closeDialog:function(){h(!1)}}),(0,u.jsx)(le.Z,{openSnackBar:D,closeSnackBar:function(){k(!1)},severity:A,message:I})]})}var Ze=n(1087);function me(){var e,t,n,a,o,c,s,f=(0,Ze.lr)(),p=(0,i.Z)(f,2),v=p[0],g=p[1],h=r.useState(null),Z=(0,i.Z)(h,2),m=Z[0],x=Z[1],C=r.useState(l.Z.getState().CategoryReducer.CIDList.find((function(e){return e.CID===v.get("cid")}))?null===(e=l.Z.getState().CategoryReducer.CIDList.find((function(e){return e.CID===v.get("cid")})))||void 0===e?void 0:e.NAME:null===(t=l.Z.getState().CategoryReducer.CIDList[0])||void 0===t?void 0:t.NAME),y=(0,i.Z)(C,2),j=y[0],D=y[1],k=r.useState(null===(n=l.Z.getState().CategoryReducer.CIDList.find((function(e){return e.NAME===j})))||void 0===n||null===(a=n.subCategories)||void 0===a?void 0:a.split(",")[0]),b=(0,i.Z)(k,2),S=b[0],I=b[1],E=r.useState(null===(o=l.Z.getState().ItemReducer.itemList[j][S])||void 0===o?void 0:o.slice(0,5)),w=(0,i.Z)(E,2),N=w[0],A=w[1],M=r.useState(0),_=(0,i.Z)(M,2),L=_[0],P=_[1],F=r.useState(5),B=(0,i.Z)(F,2),R=B[0],O=B[1],T=r.useState(null!==(c=null===(s=l.Z.getState().ItemReducer.itemList[j][S])||void 0===s?void 0:s.length)&&void 0!==c?c:1),z=(0,i.Z)(T,2),$=z[0],H=z[1];l.Z.subscribe((function(){var e,t,n;I(null===(e=l.Z.getState().CategoryReducer.CIDList.find((function(e){return e.NAME===j})))||void 0===e||null===(t=e.subCategories)||void 0===t?void 0:t.split(",")[0]),A(null===(n=l.Z.getState().ItemReducer.itemList[j][S])||void 0===n?void 0:n.slice(0,R))}));var q=Boolean(m);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(he,{}),(0,u.jsxs)("div",{className:"Admin_page",children:[(0,u.jsx)(d,{anchorEl:m,currType:j,open:q,typeClick:function(e){x(e.currentTarget)},subTypeChange:function(e,t){var n,i,r;x(null),D(t),I(e.target.textContent),A(null===(n=l.Z.getState().ItemReducer.itemList[t][e.target.textContent])||void 0===n?void 0:n.slice(0,R)),H(null===(i=l.Z.getState().ItemReducer.itemList[t][e.target.textContent])||void 0===i?void 0:i.length),P(0);var a=null===(r=l.Z.getState().CategoryReducer.CIDList.find((function(e){return e.NAME===t})))||void 0===r?void 0:r.CID;g("cid=".concat(a||1))},closeMenu:function(){x(null)}}),(0,u.jsx)("div",{className:"dashBoard",children:(0,u.jsx)(ue,{displayList:N,listLength:null!==$&&void 0!==$?$:1,tablePage:L,tableRowsNum:R,tablePageChange:function(e,t){var n,i;P(t),A(null===(n=l.Z.getState().ItemReducer.itemList[j][S])||void 0===n?void 0:n.slice(t*R,t*R+R)),H(null===(i=l.Z.getState().ItemReducer.itemList[j][S])||void 0===i?void 0:i.length)},tableRowsChange:function(e){var t,n;O(parseInt(e.target.value,10)),P(0),A(null===(t=l.Z.getState().ItemReducer.itemList[j][S])||void 0===t?void 0:t.slice(L*e.target.value,L*e.target.value+parseInt(e.target.value))),H(null===(n=l.Z.getState().ItemReducer.itemList[j][S])||void 0===n?void 0:n.length)},type:j,subType:S,tableHeader:[{id:"id",numeric:!0,label:"ID"},{id:"img",numeric:!1,label:"Image"},{id:"price",numeric:!0,label:"Price"},{id:"name",numeric:!0,label:"Name"},{id:"stock",numeric:!0,label:"Stock"},{id:"action",numeric:!0,label:"Action"}]})})]})]})}},7621:function(e,t,n){n.d(t,{Z:function(){return Z}});var i=n(7462),r=n(3366),a=n(2791),o=n(8182),c=n(4419),s=n(6934),l=n(1046),u=n(5527),d=n(5878),f=n(1217);function p(e){return(0,f.Z)("MuiCard",e)}(0,d.Z)("MuiCard",["root"]);var v=n(184),g=["className","raised"],h=(0,s.ZP)(u.Z,{name:"MuiCard",slot:"Root",overridesResolver:function(e,t){return t.root}})((function(){return{overflow:"hidden"}})),Z=a.forwardRef((function(e,t){var n=(0,l.Z)({props:e,name:"MuiCard"}),a=n.className,s=n.raised,u=void 0!==s&&s,d=(0,r.Z)(n,g),f=(0,i.Z)({},n,{raised:u}),Z=function(e){var t=e.classes;return(0,c.Z)({root:["root"]},p,t)}(f);return(0,v.jsx)(h,(0,i.Z)({className:(0,o.Z)(Z.root,a),elevation:u?8:void 0,ref:t,ownerState:f},d))}))}}]);
//# sourceMappingURL=2.e3f4f6ba.chunk.js.map