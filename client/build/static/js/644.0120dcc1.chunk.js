"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[644],{2644:function(e,t,n){n.r(t),n.d(t,{default:function(){return ie}});var i=n(9439),r=n(2791),a=n(9953),o=n(7621),c=n(5422),s=n(9891),l=n(8349),u=n(184);function d(e){var t,n=r.useState(e.currType),d=(0,i.Z)(n,2),f=d[0],v=d[1],h=l.Z.getState().CategoryReducer.categoryList;return(0,u.jsxs)(a.ZP,{variant:"permanent",anchor:"left",PaperProps:{sx:{position:"inherit"}},className:"drawer",children:[(0,u.jsx)("div",{className:"drawer_ContentWrapper",children:Object.keys(h).map((function(t){return(0,u.jsx)("div",{children:(0,u.jsx)(o.Z,{onClick:function(t){e.typeClick(t),v(t.target.textContent)},className:"drawer_card",children:t.toString()})},t)}))}),(0,u.jsx)(c.Z,{anchorEl:e.anchorEl,open:e.open,onClose:e.closeMenu,children:null===(t=h[f])||void 0===t?void 0:t.map((function(t){return(0,u.jsx)(s.Z,{onClick:function(t){return e.subTypeChange(t,f)},children:t},t)}))})]})}var f=n(1413),v=n(4165),h=n(5861),g=n(3433),p=n(5671),Z=n(3144),m=n(136),C=n(7277),x=n(9281),y=n(9836),j=n(6890),D=n(5855),S=n(3994),b=n(9174),I=n(720),k=n(4554),E=n(3382),N=n(8582),w=n(5447),A=n(5646),M=n(9658),_=n(828),L=n(6520),P=n(3400),F=n(9126),R=n(6918),B=n(5289),O=n(4830),z=n(9157),H=n(6151),T=n(7071),$=n(7275),q=n(7123),W=n(784);function V(e){var t,n,a,o,c,d,v,h,g,p,Z,m,C=(0,r.useState)("".concat(W.Z,"/").concat(null===(t=e.item)||void 0===t?void 0:t.PID)),x=(0,i.Z)(C,2),y=x[0],j=x[1],D=(0,r.useState)(null),S=(0,i.Z)(D,2),b=S[0],I=S[1],k=(0,r.useState)("not selected"),E=(0,i.Z)(k,2),N=E[0],w=E[1],A=(0,r.useState)(e.item),M=(0,i.Z)(A,2),_=M[0],L=M[1],P=(0,r.useRef)(),F=l.Z.getState().CategoryReducer.CIDList,R=(0,r.useState)(null!==_&&void 0!==_&&_.category?null===(n=F.find((function(e){return e.NAME===_.category})))||void 0===n||null===(a=n.subCategories)||void 0===a?void 0:a.split(","):null===(o=F[0])||void 0===o?void 0:o.subCategories.split(",")),V=(0,i.Z)(R,2),U=V[0],G=V[1],J=function(e,t){var n,i,r=(0,f.Z)({},_);"category"===t&&e.target.value!==(null===_||void 0===_?void 0:_.category)&&(r.subCategory=null===(n=F.find((function(t){return t.NAME===e.target.value})))||void 0===n?void 0:n.subCategories.split(",")[0],r.CID=null===(i=F.find((function(t){return t.NAME===e.target.value})))||void 0===i?void 0:i.CID);r[t]=e.target.value,L(r)},K=function(){j(null),L(null),w("not selected")};return(0,r.useEffect)((function(){var t,n,i,r,a,o,c,s;(L(e.item),null!==(t=e.item)&&void 0!==t&&t.category)?(j("".concat(W.Z,"/").concat(null===(n=e.item)||void 0===n?void 0:n.PID)),G(null===(i=F.find((function(t){return t.NAME===e.item.category})))||void 0===i||null===(r=i.subCategories)||void 0===r?void 0:r.split(","))):(L((0,f.Z)((0,f.Z)({},e.item),{},{category:null===(a=F[0])||void 0===a?void 0:a.NAME,subCategory:null===(o=F[0])||void 0===o?void 0:o.subCategories.split(",")[0]})),j(null),G(null===(c=F[0])||void 0===c||null===(s=c.subCategories)||void 0===s?void 0:s.split(",")));return function(){K()}}),[e.item,F]),(0,u.jsxs)(B.Z,{open:e.open,onClose:function(){e.closeDialog(),K()},maxWidth:"lg",fullWidth:!0,scroll:"body",children:[(0,u.jsx)(O.Z,{children:(0,u.jsx)("div",{className:"EditDialog_title",children:"Editing"})}),(0,u.jsxs)(z.Z,{className:"EditDialog_contentWrapper",children:[(0,u.jsxs)("div",{className:"EditDialog_leftContent",children:[(0,u.jsxs)(H.Z,{variant:"contained",onClick:function(){P.current.click()},children:["Click to upload file",(0,u.jsx)("input",{ref:P,type:"file",accept:"image/png,image/gif,image/jpg",onChange:function(e){return function(e){var t;e.target.files&&(w(null===(t=e.target.files[0])||void 0===t?void 0:t.name),j(URL.createObjectURL(e.target.files[0])),I(e.target.files[0]))}(e)},className:"EditDialog_imgInput"})]}),(0,u.jsx)("br",{}),(0,u.jsx)("img",{onDrop:function(e){return function(e){var t;e.preventDefault(),e.dataTransfer.files&&(w(null===(t=e.dataTransfer.files[0])||void 0===t?void 0:t.name),j(URL.createObjectURL(e.dataTransfer.files[0])),I(e.target.files[0]))}(e)},onDragOver:function(e){return function(e){e.preventDefault()}(e)},className:"EditDialog_imgUploadArea",src:y,alt:" or drag and drop your file here"}),(0,u.jsx)(T.Z,{children:N}),(0,u.jsx)($.Z,{required:!0,label:"Name",variant:"outlined",margin:"dense",onChange:function(e){return J(e,"name")},defaultValue:null===(c=e.item)||void 0===c?void 0:c.name}),(0,u.jsx)($.Z,{required:!0,label:"PrevPrice",variant:"outlined",margin:"dense",onChange:function(e){return J(e,"prevPrice")},defaultValue:null===(d=e.item)||void 0===d?void 0:d.prevPrice}),(0,u.jsx)($.Z,{required:!0,label:"Price",variant:"outlined",margin:"dense",onChange:function(e){return J(e,"price")},defaultValue:null===(v=e.item)||void 0===v?void 0:v.price}),(0,u.jsx)($.Z,{required:!0,label:"Stock",variant:"outlined",margin:"dense",onChange:function(e){return J(e,"inventory")},defaultValue:null===(h=e.item)||void 0===h?void 0:h.inventory})]}),(0,u.jsxs)("div",{className:"EditDialog_rightContent",children:[(0,u.jsx)($.Z,{required:!0,label:"Description",variant:"outlined",className:"EditDialog_formComponent",onChange:function(e){return J(e,"description")},defaultValue:null===(g=e.item)||void 0===g?void 0:g.description,multiline:!0,rows:10,margin:"dense"}),(0,u.jsx)($.Z,{select:!0,label:"Type",value:(null===_||void 0===_?void 0:_.category)||(null===(p=F[0])||void 0===p?void 0:p.NAME),helperText:"Please select type",onChange:function(e){var t;J(e,"category"),G(null===(t=F.find((function(t){return t.NAME===e.target.value})))||void 0===t?void 0:t.subCategories.split(","))},margin:"dense",children:null===F||void 0===F?void 0:F.map((function(e){return(0,u.jsx)(s.Z,{value:e.NAME,children:e.NAME},e.CID)}))}),(0,u.jsx)($.Z,{select:!0,label:"Subtype",value:null!==_&&void 0!==_&&_.subCategory?null===_||void 0===_?void 0:_.subCategory:null===(Z=F[0])||void 0===Z?void 0:Z.subCategories.split(",")[0],helperText:"Please select subtype",onChange:function(e){J(e,"subCategory")},margin:"dense",children:U?null===U||void 0===U?void 0:U.map((function(e){return(0,u.jsx)(s.Z,{value:e,children:e},e)})):(0,u.jsx)(s.Z,{})}),(0,u.jsx)($.Z,{required:!0,label:"comeFrom",variant:"outlined",margin:"dense",onChange:function(e){return J(e,"comeFrom")},defaultValue:null===(m=e.item)||void 0===m?void 0:m.comeFrom})]})]}),(0,u.jsxs)(q.Z,{children:[(0,u.jsx)(H.Z,{onClick:e.closeDialog,children:"Back"}),(0,u.jsx)(H.Z,{onClick:function(){var t=(0,f.Z)({},_);console.log("data is",t),e.submitHandler(t,b),e.closeDialog()},children:"Submit"})]})]})}var U=n(8652),G=n(2032),J=n(6212),K=n(3362),Q=function(e){(0,m.Z)(n,e);var t=(0,C.Z)(n);function n(){var e;(0,p.Z)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={selectedItems:[],detailDialogOpen:!1,detailDialogItem:null,editDialogOpen:!1,editDialogItem:null,openSuccessSnackBar:!1,successSnackBarMessage:"",openFailSnackBar:!1,failSnackBarMessage:!1},e.AllClick=function(t){t.target.checked?e.setState({selectedItems:(0,g.Z)(e.props.displayList)}):e.setState({selectedItems:[]})},e.fetchData=(0,h.Z)((0,v.Z)().mark((function e(){var t;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.Z.get_categoryList().then((function(e){return t=e.data})).catch((function(e){return console.log(e)}));case 2:return e.next=4,U.Z.get_productList().then((function(e){var n=e.data,i={},r={},a={};t.forEach((function(e){i[e.NAME]={};var t=e.subCategories.split(",");r[e.NAME]=t,a[e.NAME]=e.NavListIcon,t.forEach((function(t){i[e.NAME][t]=[]}))})),n.forEach((function(e){var n;e.inventory=parseInt(e.inventory),e.category=null===(n=t.find((function(t){return t.CID===e.CID})))||void 0===n?void 0:n.NAME,i[e.category][e.subCategory].push(e)})),l.Z.dispatch((0,J.qA)(a)),l.Z.dispatch((0,J.af)(r)),l.Z.dispatch((0,G.t)(i)),l.Z.dispatch((0,J.io)(t))})).catch((function(e){return console.log(e)}));case 4:return e.next=6,U.Z.get_homeList().then((function(e){var t=e.data,n=[];t.forEach((function(e){var t={name:e.name,id:e.CID,value:e.value.split(",")};n.push(t)})),l.Z.dispatch((0,K.c)(n))})).catch((function(e){return console.log(e)}));case 6:case"end":return e.stop()}}),e)}))),e.checkHandler=function(t,n){if(t.target.checked)e.setState({selectedItems:[].concat((0,g.Z)(e.state.selectedItems),[n])});else{var i=e.state.selectedItems.filter((function(e){return e.PID!==n.PID}));e.setState({selectedItems:i})}},e.openDetailDialog=function(t){e.setState({detailDialogItem:t,detailDialogOpen:!0})},e.closeDetailDialog=function(){e.setState({detailDialogItem:null,detailDialogOpen:!1})},e.openEditDialog=function(t){e.setState({editDialogItem:t,editDialogOpen:!0})},e.closeEditDialog=function(){e.setState({editDialogItem:null,editDialogOpen:!1})},e.closeSuccessSnackBar=function(){e.setState({openSuccessSnackBar:!1})},e.closeFailSnackBar=function(){e.setState({openFailSnackBar:!1})},e.checking=function(e,t){var n="",i="",r="";return e.name||(n+="Name "),e.prevPrice||(n+="PrevPirce "),e.price||(n+="Price "),e.inventory||(n+="Stock "),e.description||(n+="Description "),e.comeFrom||(n+="Comefrom "),n&&(n+="missing! "),/^-?[0-9]+([.,][0-9]+)?$/.test(e.price)&&/^-?[0-9]+([.,][0-9]+)?$/.test(e.prevPrice)||(i+="price "),/^\d+$/.test(e.inventory)||(i+="inventory "),/^[A-Za-z]+$/.test(e.name)||(i+="name "),/^[A-Za-z]+$/.test(e.ComeFrom)||(i+="comeFrom "),/^[a-zA-Z ]*$/.test(e.Descrition)||(i+="Description "),i&&(i+="format not correct! "),(null===t||void 0===t?void 0:t.size)>5240880&&(r="image too big,pls upload size below 5MB"),n+" "+i+r},e.submitHandler=function(t,n){console.log("receiving data",t);var i=(0,f.Z)({},t),r=e.checking(i,n);if(" "===r){var a=new FormData;Object.keys(i).forEach((function(e){a.append(e,t[e])})),n&&a.append("file",n,null===n||void 0===n?void 0:n.name),U.Z.update_to_productList(a).then(function(){var t=(0,h.Z)((0,v.Z)().mark((function t(n){return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({openSuccessSnackBar:!0,successSnackBarMessage:n.data}),e.closeEditDialog(),t.next=4,e.fetchData();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.setState({openFailSnackBar:!0,failSnackBarMessage:t.response.data})}))}else e.setState({openFailSnackBar:!0,failSnackBarMessage:"Insert Failed => ".concat(r)})},e.deleteItem=function(t){if(window.confirm("delete it?")){var n=new FormData;n.append("PID",null===t||void 0===t?void 0:t.PID),U.Z.delete_from_productList(n).then((function(t){console.log("receive res",t.data),e.setState({openSuccessSnackBar:!0,successSnackBarMessage:t.data}),e.fetchData()})).catch((function(t){e.setState({openFailSnackBar:!0,failSnackBarMessage:t.response.data})}))}},e}return(0,Z.Z)(n,[{key:"render",value:function(){var e,t=this,n="center";return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(x.Z,{children:[(0,u.jsxs)(y.Z,{children:[(0,u.jsx)(j.Z,{children:(0,u.jsxs)(D.Z,{children:[(0,u.jsxs)(S.Z,{padding:"checkbox",children:[(0,u.jsx)(b.Z,{color:"primary",checked:this.state.selectedItems.length===this.props.listLength,onChange:function(e){return t.AllClick(e)}}),this.state.selectedItems.length>0?(0,u.jsx)("button",{children:"Remove Selected"}):(0,u.jsx)("div",{})]}),this.props.tableHeader.map((function(e){return(0,u.jsx)(S.Z,{align:"left",children:(0,u.jsxs)(I.Z,{active:!1,direction:"asc",children:[e.label,(0,u.jsx)(k.Z,{component:"span"})]})},e.id)}))]})}),(0,u.jsx)(E.Z,{children:null===(e=this.props.displayList)||void 0===e?void 0:e.map((function(e){return(0,u.jsxs)(D.Z,{children:[(0,u.jsx)(S.Z,{padding:"checkbox",children:(0,u.jsx)(b.Z,{color:"primary",checked:t.state.selectedItems.findIndex((function(t){return t.PID===e.PID}))>-1,onChange:function(n){return t.checkHandler(n,e)}})}),(0,u.jsx)(S.Z,{children:e.PID}),(0,u.jsx)(S.Z,{children:(0,u.jsx)("div",{children:(0,u.jsx)("img",{src:"".concat(W.Z,"/").concat(e.PID),alt:"not found",className:"adminTable_img"})})}),(0,u.jsxs)(S.Z,{children:["$",e.price]}),(0,u.jsx)(S.Z,{children:e.name}),(0,u.jsx)(S.Z,{children:parseInt(e.inventory)}),(0,u.jsxs)(S.Z,{children:[(0,u.jsx)(L.Z,{title:"View",children:(0,u.jsx)(P.Z,{onClick:function(){return t.openDetailDialog(e)},children:(0,u.jsx)(F.xt8,{size:28})})}),(0,u.jsx)(L.Z,{title:"Edit",children:(0,u.jsx)(P.Z,{onClick:function(){return t.openEditDialog(e)},children:(0,u.jsx)(F.Ph1,{size:28})})}),(0,u.jsx)(L.Z,{title:"Delete",children:(0,u.jsx)(P.Z,{onClick:function(){t.deleteItem(e)},children:(0,u.jsx)(_._51,{size:28})})})]})]},e.PID)}))}),(0,u.jsx)(N.Z,{children:(0,u.jsx)(D.Z,{children:(0,u.jsx)(w.Z,{rowsPerPageOptions:[5,10,15],count:this.props.listLength,rowsPerPage:this.props.tableRowsNum,page:this.props.tablePage,onPageChange:function(e,n){return t.props.tablePageChange(e,n)},onRowsPerPageChange:function(e){return t.props.tableRowsChange(e)}})})})]}),(0,u.jsx)(R.Z,(0,f.Z)((0,f.Z)({},this.state.detailDialogItem),{},{type:this.props.type,subType:this.props.subType,open:this.state.detailDialogOpen,openDialog:this.openDetailDialog,closeDialog:this.closeDetailDialog})),(0,u.jsx)(V,{submitHandler:this.submitHandler,item:this.state.editDialogItem,open:this.state.editDialogOpen,closeDialog:this.closeEditDialog})]}),(0,u.jsx)(A.Z,{open:this.state.openSuccessSnackBar,autoHideDuration:9e3,onClose:this.closeSuccessSnackBar,anchorOrigin:{vertical:"top",horizontal:n},children:(0,u.jsx)(M.Z,{onClose:this.closeSuccessSnackBar,severity:"success",sx:{width:"100%"},children:this.state.successSnackBarMessage})}),(0,u.jsx)(A.Z,{open:this.state.openFailSnackBar,autoHideDuration:9e3,onClose:this.closeFailSnackBar,anchorOrigin:{vertical:"top",horizontal:n},children:(0,u.jsx)(M.Z,{onClose:this.closeFailSnackBar,severity:"error",children:this.state.failSnackBarMessage})})]})}}]),n}(r.Component),X=n(6362);function Y(e){var t=(0,r.useState)(e.content),n=(0,i.Z)(t,2),a=n[0],o=n[1],c=(0,r.useState)(e.content),s=(0,i.Z)(c,2),l=s[0],d=s[1];return(0,r.useEffect)((function(){o(e.content),d(e.content)}),[e.content]),(0,u.jsxs)(B.Z,{open:e.open,onClose:e.closeDialog,maxWidth:"xs",fullWidth:!0,scroll:"body",children:[(0,u.jsx)(O.Z,{children:e.title}),(0,u.jsx)(z.Z,{children:(0,u.jsx)(X.Z,{children:(0,u.jsx)($.Z,{required:!0,label:e.title,variant:"outlined",value:a,onChange:function(e){return function(e){o(e.target.value)}(e)},autoFocus:!0,className:"TextFieldDialog_textfield"})})}),(0,u.jsxs)(q.Z,{children:[(0,u.jsx)(H.Z,{onClick:e.closeDialog,children:"Back"}),(0,u.jsx)(H.Z,{onClick:function(){e.submitHandler(a,l),o(""),e.closeDialog()},children:"Submit"})]})]})}function ee(e){var t,n,a,o=(0,r.useState)(l.Z.getState().CategoryReducer.CIDList),c=(0,i.Z)(o,2),d=c[0],f=c[1],g=(0,r.useState)(null===(t=d[0])||void 0===t?void 0:t.NAME),p=(0,i.Z)(g,2),Z=p[0],m=p[1],C=(0,r.useState)(null===(n=d[0])||void 0===n||null===(a=n.subCategories)||void 0===a?void 0:a.split(",")),b=(0,i.Z)(C,2),I=b[0],k=b[1],N=(0,r.useState)(!1),w=(0,i.Z)(N,2),R=w[0],T=w[1],W=(0,r.useState)("new"),V=(0,i.Z)(W,2),Q=V[0],X=V[1],ee=(0,r.useState)(""),te=(0,i.Z)(ee,2),ne=te[0],ie=te[1],re=(0,r.useState)(null),ae=(0,i.Z)(re,2),oe=ae[0],ce=ae[1],se=(0,r.useState)(!1),le=(0,i.Z)(se,2),ue=le[0],de=le[1],fe=(0,r.useState)(""),ve=(0,i.Z)(fe,2),he=ve[0],ge=ve[1],pe=(0,r.useState)(!1),Ze=(0,i.Z)(pe,2),me=Ze[0],Ce=Ze[1],xe=(0,r.useState)(""),ye=(0,i.Z)(xe,2),je=ye[0],De=ye[1],Se="center",be=function(e,t,n){X(e),ie(t),ce(n),T(!0)},Ie=function(){de(!1)},ke=function(){Ce(!1)},Ee=function(){var e=(0,h.Z)((0,v.Z)().mark((function e(){var t;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.Z.get_categoryList().then((function(e){return t=e.data})).catch((function(e){return console.log(e)}));case 2:return e.next=4,U.Z.get_productList().then((function(e){var n=e.data,i={},r={},a={};t.forEach((function(e){i[e.NAME]={};var t=e.subCategories.split(",");r[e.NAME]=t,a[e.NAME]=e.NavListIcon,t.forEach((function(t){i[e.NAME][t]=[]}))})),n.forEach((function(e){var n;e.inventory=parseInt(e.inventory),e.category=null===(n=t.find((function(t){return t.CID===e.CID})))||void 0===n?void 0:n.NAME,i[e.category][e.subCategory].push(e)})),l.Z.dispatch((0,J.qA)(a)),l.Z.dispatch((0,J.af)(r)),l.Z.dispatch((0,G.t)(i)),l.Z.dispatch((0,J.io)(t))})).catch((function(e){return console.log(e)}));case 4:return e.next=6,U.Z.get_homeList().then((function(e){var t=e.data,n=[];t.forEach((function(e){var t={name:e.name,id:e.CID,value:e.value.split(",")};n.push(t)})),l.Z.dispatch((0,K.c)(n))})).catch((function(e){return console.log(e)}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ne=function(e){return/^[a-zA-Z ]*$/.test(e)},we=function(e,t){var n;if(!e||!Ne(e))return De("Format not match!"),void Ce(!0);var i=new FormData,r={CID:null===(n=d.find((function(e){return e.NAME===Z})))||void 0===n?void 0:n.CID,category:Z,newIcon:e};Object.keys(r).forEach((function(e){i.append(e,r[e])})),U.Z.update_icon_to_category(i).then((function(e){ge(e.data),de(!0),Ee()})).catch((function(e){De("insert fail "+e.response.data),Ce(!0)}))},Ae=function(e,t){var n;if(!e||!Ne(e))return De("Format not match!"),void Ce(!0);var i=new FormData,r={CID:null===(n=d.find((function(e){return e.NAME===Z})))||void 0===n?void 0:n.CID,category:Z,originSubCategory:t,newSubCategory:e};Object.keys(r).forEach((function(e){i.append(e,r[e])})),U.Z.update_subCate_to_category(i).then(function(){var e=(0,h.Z)((0,v.Z)().mark((function e(t){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ge(t.data),de(!0),e.next=4,Ee();case 4:f(l.Z.getState().CategoryReducer.CIDList);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){De("insert fail "+e.response.data),Ce(!0)}))},Me=function(e,t){var n;if(!e||!Ne(e))return De("Format not match!"),void Ce(!0);var i=new FormData,r={CID:null===(n=d.find((function(e){return e.NAME===Z})))||void 0===n?void 0:n.CID,originCategory:t,newCategory:e};Object.keys(r).forEach((function(e){i.append(e,r[e])})),U.Z.update_to_category(i).then(function(){var t=(0,h.Z)((0,v.Z)().mark((function t(n){return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ge(n.data),de(!0),t.next=4,Ee();case 4:m(e),f(l.Z.getState().CategoryReducer.CIDList);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){De("insert fail "+e.response.data),Ce(!0)}))},_e=function(e,t){var n;if(!e||!Ne(e))return De("Format not match!"),void Ce(!0);var i=new FormData,r={CID:null===(n=d.find((function(e){return e.NAME===Z})))||void 0===n?void 0:n.CID,category:Z,subCategory:e};Object.keys(r).forEach((function(e){i.append(e,r[e])})),U.Z.insert_subCate_to_category(i).then(function(){var e=(0,h.Z)((0,v.Z)().mark((function e(t){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ge(t.data),de(!0),e.next=4,Ee();case 4:f(l.Z.getState().CategoryReducer.CIDList);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){De("insert fail "+e.response.data),Ce(!0)}))},Le=function(e,t){var n;if(!e||!Ne(e))return De("Format not match!"),void Ce(!0);var i=new FormData,r={CID:null===(n=d.find((function(e){return e.NAME===Z})))||void 0===n?void 0:n.CID,category:e,subCategory:"new"};Object.keys(r).forEach((function(e){i.append(e,r[e])})),U.Z.insert_to_category(i).then(function(){var t=(0,h.Z)((0,v.Z)().mark((function t(n){return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ge(n.data),de(!0),t.next=4,Ee();case 4:m(e),f(l.Z.getState().CategoryReducer.CIDList);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){De("insert fail "+e.response.data),Ce(!0)}))};return(0,r.useEffect)((function(){var e,t;k(null===(e=d.find((function(e){return e.NAME===Z})))||void 0===e||null===(t=e.subCategories)||void 0===t?void 0:t.split(","))}),[d,Z]),(0,u.jsxs)("div",{children:[(0,u.jsxs)(B.Z,{open:e.open,onClose:e.closeDialog,maxWidth:"lg",fullWidth:!0,scroll:"body",children:[(0,u.jsx)(O.Z,{children:(0,u.jsx)("div",{className:"EditCateDialog_title",children:"Editing category"})}),(0,u.jsxs)(z.Z,{className:"EditCateDialog_dialogContent",children:[(0,u.jsx)(H.Z,{onClick:function(){return be("create Category","",(function(){return Le}))},children:"new Category"}),(0,u.jsx)(H.Z,{onClick:function(){return be("create subCategory for ".concat(Z),"",(function(){return _e}))},children:"new SubCategory"}),(0,u.jsx)($.Z,{select:!0,label:"Category",value:Z,helperText:"Please select category",onChange:function(e){!function(e){var t,n;m(e.target.value),k(null===(t=d.find((function(t){return t.NAME===e.target.value})))||void 0===t||null===(n=t.subCategories)||void 0===n?void 0:n.split(","))}(e)},className:"EditCateDialog_selectField",children:null===d||void 0===d?void 0:d.map((function(e){return(0,u.jsx)(s.Z,{value:e.NAME,children:e.NAME},e.CID)}))}),(0,u.jsx)(H.Z,{variant:"outlined",onClick:function(){return be("Editing ".concat(Z),Z,(function(){return Me}))},children:"Edit category"}),(0,u.jsx)(H.Z,{variant:"outlined",onClick:function(){return be("Editing ".concat(Z," icon"),"",(function(){return we}))},children:"Edit category icon"}),(0,u.jsx)(H.Z,{variant:"outlined",color:"error",onClick:function(){var e;if(window.confirm("you can't delete it if there are items belongs to this category,continue?")){var t=new FormData,n={CID:null===(e=d.find((function(e){return e.NAME===Z})))||void 0===e?void 0:e.CID,category:Z};Object.keys(n).forEach((function(e){t.append(e,n[e])})),U.Z.delete_from_category(t).then(function(){var e=(0,h.Z)((0,v.Z)().mark((function e(t){var n;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ge(t.data),de(!0),e.next=4,Ee();case 4:m(null===(n=d.find((function(e){return e.NAME!==Z})))||void 0===n?void 0:n.NAME),f(l.Z.getState().CategoryReducer.CIDList);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){De("delete fail "+e.response.data),Ce(!0)}))}},children:"Delete category"}),(0,u.jsx)(x.Z,{children:(0,u.jsxs)(y.Z,{children:[(0,u.jsx)(j.Z,{children:(0,u.jsxs)(D.Z,{children:[(0,u.jsx)(S.Z,{children:"subCategory"}),(0,u.jsx)(S.Z,{children:"Action"})]})}),(0,u.jsx)(E.Z,{children:null===I||void 0===I?void 0:I.map((function(e){return(0,u.jsxs)(D.Z,{children:[(0,u.jsx)(S.Z,{children:e}),(0,u.jsxs)(S.Z,{children:[(0,u.jsx)(L.Z,{title:"Edit",children:(0,u.jsx)(P.Z,{onClick:function(){return be("edit subcate",e,(function(){return Ae}))},children:(0,u.jsx)(F.Ph1,{size:28})})}),(0,u.jsx)(L.Z,{title:"Delete",children:(0,u.jsx)(P.Z,{onClick:function(){return function(e){var t;if(window.confirm("you can not delete any category before its' items are deleted,continue?")){var n=new FormData,i={CID:null===(t=d.find((function(e){return e.NAME===Z})))||void 0===t?void 0:t.CID,category:Z,subCategory:e};Object.keys(i).forEach((function(e){n.append(e,i[e])})),U.Z.delete_subCate_from_category(n).then(function(){var e=(0,h.Z)((0,v.Z)().mark((function e(t){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ge(t.data),de(!0),e.next=4,Ee();case 4:f(l.Z.getState().CategoryReducer.CIDList);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){De("delete fail "+e.response.data),Ce(!0)}))}}(e)},children:(0,u.jsx)(_._51,{size:28})})})]})]},e)}))})]})})]}),(0,u.jsx)(q.Z,{children:(0,u.jsx)(H.Z,{onClick:e.closeDialog,children:"Back"})})]}),(0,u.jsx)(Y,{open:R,title:Q,closeDialog:function(){T(!1)},content:ne,submitHandler:oe}),(0,u.jsx)(A.Z,{open:ue,autoHideDuration:9e3,onClose:Ie,anchorOrigin:{vertical:"top",horizontal:Se},children:(0,u.jsx)(M.Z,{onClose:Ie,severity:"success",sx:{width:"100%"},children:he})}),(0,u.jsx)(A.Z,{open:me,autoHideDuration:9e3,onClose:ke,anchorOrigin:{vertical:"top",horizontal:Se},children:(0,u.jsx)(M.Z,{onClose:ke,severity:"error",children:je})})]})}function te(e){var t=r.useState(!1),n=(0,i.Z)(t,2),a=n[0],o=n[1],c=r.useState(!1),s=(0,i.Z)(c,2),d=s[0],g=s[1],p=r.useState(!1),Z=(0,i.Z)(p,2),m=Z[0],C=Z[1],x=r.useState(!1),y=(0,i.Z)(x,2),j=y[0],D=y[1],S=r.useState(""),b=(0,i.Z)(S,2),I=b[0],k=b[1],E=r.useState(""),N=(0,i.Z)(E,2),w=N[0],_=N[1],L="center",P=function(){C(!1)},F=function(){D(!1)},R=function(){var e=(0,h.Z)((0,v.Z)().mark((function e(){var t;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.Z.get_categoryList().then((function(e){return t=e.data})).catch((function(e){return console.log(e)}));case 2:return e.next=4,U.Z.get_productList().then((function(e){var n=e.data,i={},r={},a={};t.forEach((function(e){i[e.NAME]={};var t=e.subCategories.split(",");r[e.NAME]=t,a[e.NAME]=e.NavListIcon,t.forEach((function(t){i[e.NAME][t]=[]}))})),n.forEach((function(e){var n;e.inventory=parseInt(e.inventory),e.category=null===(n=t.find((function(t){return t.CID===e.CID})))||void 0===n?void 0:n.NAME,i[e.category][e.subCategory].push(e)})),l.Z.dispatch((0,J.qA)(a)),l.Z.dispatch((0,J.af)(r)),l.Z.dispatch((0,G.t)(i)),l.Z.dispatch((0,J.io)(t))})).catch((function(e){return console.log(e)}));case 4:return e.next=6,U.Z.get_homeList().then((function(e){var t=e.data,n=[];t.forEach((function(e){var t={name:e.name,id:e.CID,value:e.value.split(",")};n.push(t)})),l.Z.dispatch((0,K.c)(n))})).catch((function(e){return console.log(e)}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,u.jsxs)("div",{className:"ButtonList_Wrapper",children:[(0,u.jsx)(H.Z,{color:"secondary",variant:"outlined",onClick:function(){o(!0)},children:"Create item"}),(0,u.jsx)(H.Z,{color:"secondary",variant:"outlined",onClick:function(){g(!0)},children:"Edit Category"}),(0,u.jsx)(H.Z,{color:"secondary",variant:"contained",onClick:function(){window.location.reload(!0)},children:"Click for reload"}),(0,u.jsx)(V,{item:{},open:a,closeDialog:function(){o(!1)},submitHandler:function(e,t){var n=(0,f.Z)({},e);console.log("in submit handler,image is ",t);var i=function(e,t){var n="",i="",r="";return e.name||(n+="Name "),e.prevPrice||(n+="PrevPirce "),e.price||(n+="Price "),e.inventory||(n+="Stock "),e.description||(n+="Description "),e.comeFrom||(n+="Comefrom "),t||(n+="Image "),n&&(n+="missing! "),/^-?[0-9]+([.,][0-9]+)?$/.test(e.price)&&/^-?[0-9]+([.,][0-9]+)?$/.test(e.prevPrice)||(i+="price "),/^\d+$/.test(e.inventory)||(i+="inventory "),/^[A-Za-z]+$/.test(e.name)||(i+="name "),/^[A-Za-z]+$/.test(e.ComeFrom)||(i+="comeFrom "),/^[A-Za-z0-9 _]*[A-Za-z0-9][A-Za-z0-9 _]*$/.test(e.Descrition)||(i+="Description "),i&&(i+="format not correct! "),(null===t||void 0===t?void 0:t.size)>5242880&&(r="image too big,pls upload beload 5MB"),n+" "+i+r}(n,t);if(" "!==i)return k("Insert Failed => ".concat(i)),void D(!0);var r=new FormData;Object.keys(n).forEach((function(t){r.append(t,e[t])})),r.append("file",t,t.name),U.Z.insert_to_productList(r).then(function(){var e=(0,h.Z)((0,v.Z)().mark((function e(t){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!1),_(t.data),C(!0),e.next=5,R();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){k("Insert Failed => ".concat(i)),D(!0)}))}}),(0,u.jsx)(ee,{open:d,closeDialog:function(){g(!1)}}),(0,u.jsx)(A.Z,{open:m,autoHideDuration:6e3,onClose:P,anchorOrigin:{vertical:"top",horizontal:L},children:(0,u.jsx)(M.Z,{onClose:P,severity:"success",sx:{width:"100%"},children:w})}),(0,u.jsx)(A.Z,{open:j,autoHideDuration:9e3,onClose:F,anchorOrigin:{vertical:"top",horizontal:L},children:(0,u.jsx)(M.Z,{onClose:F,severity:"error",children:I})})]})}var ne=n(1087);function ie(){var e,t,n,a,o,c,s,f=(0,ne.lr)(),v=(0,i.Z)(f,2),h=v[0],g=v[1],p=r.useState(null),Z=(0,i.Z)(p,2),m=Z[0],C=Z[1],x=r.useState(l.Z.getState().CategoryReducer.CIDList.find((function(e){return e.CID===h.get("cid")}))?null===(e=l.Z.getState().CategoryReducer.CIDList.find((function(e){return e.CID===h.get("cid")})))||void 0===e?void 0:e.NAME:null===(t=l.Z.getState().CategoryReducer.CIDList[0])||void 0===t?void 0:t.NAME),y=(0,i.Z)(x,2),j=y[0],D=y[1],S=r.useState(null===(n=l.Z.getState().CategoryReducer.CIDList.find((function(e){return e.NAME===j})))||void 0===n||null===(a=n.subCategories)||void 0===a?void 0:a.split(",")[0]),b=(0,i.Z)(S,2),I=b[0],k=b[1],E=r.useState(null===(o=l.Z.getState().ItemReducer.itemList[j][I])||void 0===o?void 0:o.slice(0,5)),N=(0,i.Z)(E,2),w=N[0],A=N[1],M=r.useState(0),_=(0,i.Z)(M,2),L=_[0],P=_[1],F=r.useState(5),R=(0,i.Z)(F,2),B=R[0],O=R[1],z=r.useState(null!==(c=null===(s=l.Z.getState().ItemReducer.itemList[j][I])||void 0===s?void 0:s.length)&&void 0!==c?c:1),H=(0,i.Z)(z,2),T=H[0],$=H[1];l.Z.subscribe((function(){var e,t,n;k(null===(e=l.Z.getState().CategoryReducer.CIDList.find((function(e){return e.NAME===j})))||void 0===e||null===(t=e.subCategories)||void 0===t?void 0:t.split(",")[0]),A(null===(n=l.Z.getState().ItemReducer.itemList[j][I])||void 0===n?void 0:n.slice(0,B))}));var q=Boolean(m);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(te,{}),(0,u.jsxs)("div",{className:"Admin_page",children:[(0,u.jsx)(d,{anchorEl:m,currType:j,open:q,typeClick:function(e){C(e.currentTarget)},subTypeChange:function(e,t){var n,i,r;C(null),D(t),k(e.target.textContent),A(null===(n=l.Z.getState().ItemReducer.itemList[t][e.target.textContent])||void 0===n?void 0:n.slice(0,B)),$(null===(i=l.Z.getState().ItemReducer.itemList[t][e.target.textContent])||void 0===i?void 0:i.length),P(0);var a=null===(r=l.Z.getState().CategoryReducer.CIDList.find((function(e){return e.NAME===t})))||void 0===r?void 0:r.CID;g("cid=".concat(a||1))},closeMenu:function(){C(null)}}),(0,u.jsx)("div",{className:"dashBoard",children:(0,u.jsx)(Q,{displayList:w,listLength:null!==T&&void 0!==T?T:1,tablePage:L,tableRowsNum:B,tablePageChange:function(e,t){var n,i;P(t),A(null===(n=l.Z.getState().ItemReducer.itemList[j][I])||void 0===n?void 0:n.slice(t*B,t*B+B)),$(null===(i=l.Z.getState().ItemReducer.itemList[j][I])||void 0===i?void 0:i.length)},tableRowsChange:function(e){var t,n;O(parseInt(e.target.value,10)),P(0),A(null===(t=l.Z.getState().ItemReducer.itemList[j][I])||void 0===t?void 0:t.slice(L*e.target.value,L*e.target.value+parseInt(e.target.value))),$(null===(n=l.Z.getState().ItemReducer.itemList[j][I])||void 0===n?void 0:n.length)},type:j,subType:I,tableHeader:[{id:"id",numeric:!0,label:"ID"},{id:"img",numeric:!1,label:"Image"},{id:"price",numeric:!0,label:"Price"},{id:"name",numeric:!0,label:"Name"},{id:"stock",numeric:!0,label:"Stock"},{id:"action",numeric:!0,label:"Action"}]})})]})]})}}}]);
//# sourceMappingURL=644.0120dcc1.chunk.js.map